<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>××‘×¦×¢ ××’×™×œ×” - ×—×“×¨ ×‘×¨×™×—×”</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;700;900&family=Rubik:wght@400;700&display=swap');
        
        :root {
            --primary-blue: #0038a8;
            --israel-blue: #0038a8;
            --sepia-dark: #3d2817;
            --sepia-light: #f4e8d8;
            --vintage-yellow: #f4d03f;
            --success-green: #27ae60;
            --danger-red: #c0392b;
            --shadow: rgba(0, 0, 0, 0.3);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Heebo', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .app-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
        }
        
        .screen {
            display: none;
        }
        
        .screen.active {
            display: block;
        }
        
        /* Intro Screen */
        .intro-screen {
            text-align: center;
            padding: 40px 20px;
            animation: fadeIn 0.8s ease-out;
        }
        
        .mission-badge {
            width: 120px;
            height: 120px;
            margin: 0 auto 30px;
            background: linear-gradient(135deg, var(--israel-blue), #0051c7);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            box-shadow: 0 10px 40px rgba(0, 56, 168, 0.5);
            animation: pulse 2s infinite;
        }
        
        .intro-screen h1 {
            font-size: 2.8rem;
            font-weight: 900;
            margin-bottom: 15px;
            text-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
            letter-spacing: 2px;
        }
        
        .intro-screen .subtitle {
            font-size: 1.3rem;
            color: var(--vintage-yellow);
            margin-bottom: 30px;
            font-weight: 700;
        }
        
        .story-box {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            text-align: right;
            line-height: 1.8;
            font-size: 1.1rem;
        }
        
        .start-button {
            background: linear-gradient(135deg, var(--success-green), #229954);
            color: white;
            border: none;
            padding: 18px 50px;
            font-size: 1.3rem;
            font-weight: 700;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 8px 20px rgba(39, 174, 96, 0.4);
            transition: all 0.3s;
            font-family: 'Heebo', sans-serif;
        }
        
        .start-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(39, 174, 96, 0.6);
        }
        
        /* Timer and Progress */
        .header-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .timer {
            font-size: 2rem;
            font-weight: 900;
            color: var(--vintage-yellow);
            font-family: 'Rubik', sans-serif;
            letter-spacing: 2px;
        }
        
        .timer.warning {
            color: #e74c3c;
            animation: blink 1s infinite;
        }
        
        .progress-locks {
            display: flex;
            gap: 15px;
        }
        
        .lock-icon {
            font-size: 1.8rem;
            opacity: 0.3;
            transition: all 0.5s;
        }
        
        .lock-icon.unlocked {
            opacity: 1;
            color: var(--success-green);
            transform: scale(1.2);
        }
        
        /* Station Card */
        .station-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 20px;
            animation: slideIn 0.6s ease-out;
        }
        
        .station-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .station-number {
            font-size: 1rem;
            color: var(--vintage-yellow);
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .station-title {
            font-size: 2rem;
            font-weight: 900;
            margin-bottom: 15px;
        }
        
        .station-description {
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.6;
            text-align: right;
        }
        
        /* Station 1: Cipher */
        .cipher-table {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            margin: 30px 0;
            direction: ltr;
        }
        
        .cipher-cell {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            font-weight: 700;
            transition: all 0.3s;
        }
        
        .cipher-letter {
            font-size: 1.5rem;
            margin-bottom: 5px;
        }
        
        .cipher-number {
            font-size: 1rem;
            color: var(--vintage-yellow);
        }
        
        .cipher-input-section {
            margin-top: 30px;
        }
        
        .cipher-input {
            width: 100%;
            padding: 15px;
            font-size: 1.2rem;
            font-family: 'Heebo', sans-serif;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            text-align: right;
        }
        
        /* Station 2: Voting */
        .voting-area {
            margin: 30px 0;
        }
        
        .country-card {
            background: rgba(255, 255, 255, 0.15);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .country-name {
            font-size: 1.3rem;
            font-weight: 700;
        }
        
        .vote-buttons {
            display: flex;
            gap: 10px;
        }
        
        .vote-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Heebo', sans-serif;
        }
        
        .vote-btn.yes {
            background: var(--success-green);
            color: white;
        }
        
        .vote-btn.no {
            background: var(--danger-red);
            color: white;
        }
        
        .vote-btn.abstain {
            background: #7f8c8d;
            color: white;
        }
        
        .vote-btn:hover:not(:disabled) {
            transform: scale(1.05);
        }
        
        .vote-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .vote-counter {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            text-align: center;
        }
        
        .vote-counter-title {
            font-size: 1.1rem;
            margin-bottom: 10px;
            color: var(--vintage-yellow);
        }
        
        .vote-numbers {
            display: flex;
            justify-content: space-around;
            margin-top: 15px;
        }
        
        .vote-stat {
            text-align: center;
        }
        
        .vote-stat-number {
            font-size: 2rem;
            font-weight: 900;
            font-family: 'Rubik', sans-serif;
        }
        
        .vote-stat-label {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
            margin-top: 5px;
        }
        
        /* Station 3: Signers */
        .signers-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin: 30px 0;
        }
        
        .signer-card {
            background: rgba(255, 255, 255, 0.1);
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            min-height: 280px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .signer-card:hover:not(.selected):not(.disabled) {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(244, 208, 63, 0.3);
        }
        
        .signer-card.selected {
            background: linear-gradient(135deg, var(--success-green), #229954);
            border-color: var(--success-green);
            box-shadow: 0 8px 20px rgba(39, 174, 96, 0.5);
        }
        
        .signer-card.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .signer-name {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 8px;
        }
        
        .signer-role {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
        }
        
        /* Station 4: Timeline */
        .timeline-container {
            margin: 30px 0;
        }
        
        .timeline-events {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .timeline-event {
            background: rgba(255, 255, 255, 0.15);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            padding: 20px;
            cursor: grab;
            transition: all 0.3s;
            user-select: none;
        }
        
        .timeline-event:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(5px);
        }
        
        .timeline-event.dragging {
            opacity: 0.5;
            cursor: grabbing;
        }
        
        .timeline-event.correct {
            background: linear-gradient(135deg, rgba(39, 174, 96, 0.3), rgba(34, 153, 84, 0.3));
            border-color: var(--success-green);
        }
        
        .event-number {
            display: inline-block;
            width: 30px;
            height: 30px;
            background: var(--vintage-yellow);
            color: #000;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            font-weight: 900;
            margin-left: 15px;
        }
        
        .event-text {
            display: inline;
            font-size: 1.1rem;
            font-weight: 700;
        }
        
        /* Station 5: Megillah Completion */
        .megillah-text {
            background: rgba(244, 232, 216, 0.1);
            border: 3px solid var(--vintage-yellow);
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
            line-height: 2;
            font-size: 1.2rem;
            text-align: right;
        }
        
        .word-blank {
            display: inline-block;
            min-width: 150px;
            padding: 5px 15px;
            background: rgba(255, 255, 255, 0.2);
            border: 2px dashed white;
            border-radius: 8px;
            margin: 0 5px;
            text-align: center;
            font-weight: 700;
            color: var(--vintage-yellow);
        }
        
        .word-options {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        .word-option {
            padding: 15px 30px;
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1.2rem;
            font-weight: 700;
        }
        
        .word-option:hover:not(.selected):not(.disabled) {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-3px);
        }
        
        .word-option.selected {
            background: var(--success-green);
            border-color: var(--success-green);
        }
        
        .word-option.disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        
        /* Submit Button */
        .submit-button {
            background: linear-gradient(135deg, var(--israel-blue), #0051c7);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.2rem;
            font-weight: 700;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 8px 20px rgba(0, 56, 168, 0.4);
            transition: all 0.3s;
            margin-top: 20px;
            font-family: 'Heebo', sans-serif;
            width: 100%;
        }
        
        .submit-button:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(0, 56, 168, 0.6);
        }
        
        .submit-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        /* Success/Error Messages */
        .message {
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            text-align: center;
            font-weight: 700;
            animation: slideIn 0.5s ease-out;
        }
        
        .message.success {
            background: rgba(39, 174, 96, 0.3);
            border: 2px solid var(--success-green);
        }
        
        .message.error {
            background: rgba(192, 57, 43, 0.3);
            border: 2px solid var(--danger-red);
        }
        
        /* Victory Screen */
        .victory-screen {
            text-align: center;
            padding: 40px 20px;
            animation: fadeIn 1s ease-out;
        }
        
        .victory-screen h1 {
            font-size: 3rem;
            font-weight: 900;
            margin-bottom: 30px;
            color: var(--vintage-yellow);
        }
        
        .stars {
            font-size: 3rem;
            margin: 20px 0;
        }
        
        .final-time {
            font-size: 1.5rem;
            color: var(--vintage-yellow);
            margin: 20px 0;
        }
        
        /* Animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }
        
        @keyframes blink {
            0%, 50%, 100% {
                opacity: 1;
            }
            25%, 75% {
                opacity: 0.3;
            }
        }
        
        /* Responsive */
        @media (max-width: 600px) {
            .intro-screen h1 {
                font-size: 2rem;
            }
            
            .station-title {
                font-size: 1.5rem;
            }
            
            .cipher-table {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .vote-numbers {
                flex-direction: column;
                gap: 15px;
            }
            
            .word-options {
                flex-direction: column;
            }
            
            .signers-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Intro Screen -->
        <div id="introScreen" class="screen active intro-screen">
            <div class="mission-badge">ğŸ¯</div>
            <h1>××‘×¦×¢ ××’×™×œ×”</h1>
            <p class="subtitle">××©×™××” ×¡×•×“×™×ª â€¢ ×¨××ª ×“×—×™×¤×•×ª: ×’×‘×•×”×”</p>
            
            <div class="story-box">
                <p>
                    <strong>×©×¢×”: 14:00 â€¢ 14 ×‘×××™ 1948</strong><br/><br/>
                    
                    ×“×•×“ ×‘×Ÿ ×’×•×¨×™×•×Ÿ ×¢×•××“ ×œ×¢×œ×•×ª ×œ×‘××” ×‘×¢×•×“ 90 ×“×§×•×ª ×›×“×™ ×œ×”×›×¨×™×– ×¢×œ ×”×§××ª ××“×™× ×ª ×™×©×¨××œ.<br/><br/>
                    
                    ××‘×œ... ×—×œ×§×™× ×§×¨×™×˜×™×™× ××”××’×™×œ×” ×•××”××¡××›×™× × ×¢×œ××•!<br/><br/>
                    
                    ××ª× ×”×¡×•×›× ×™× ×”×—×©××™×™× ×©×œ "×”××“×™× ×” ×©×‘×“×¨×š".<br/>
                    ×”××©×™××” ×©×œ×›×: ×œ×¤×¦×— 5 ×§×•×“×™× ×•×œ×”×©×œ×™× ××ª ×”×›× ×•×ª ×”×”×›×¨×–×” ×œ×¤× ×™ ×©×××•×—×¨ ××“×™.<br/><br/>
                    
                    <strong>×‘×œ×™ ×–×” - ××™×Ÿ ××“×™× ×”!</strong>
                </p>
            </div>
            
            <button class="start-button" onclick="startGame()">
                ğŸš€ ×”×ª×—×œ ××©×™××”
            </button>
        </div>

        <!-- Game Screen -->
        <div id="gameScreen" class="screen">
            <div class="header-bar">
                <div id="timer" class="timer">â° 90:00</div>
                
                <div class="progress-locks">
                    <div id="lock0" class="lock-icon">ğŸ”’</div>
                    <div id="lock1" class="lock-icon">ğŸ”’</div>
                    <div id="lock2" class="lock-icon">ğŸ”’</div>
                    <div id="lock3" class="lock-icon">ğŸ”’</div>
                    <div id="lock4" class="lock-icon">ğŸ”’</div>
                </div>
            </div>
            
            <div id="stationContainer"></div>
        </div>

        <!-- Victory Screen -->
        <div id="victoryScreen" class="screen victory-screen">
            <h1>ğŸ‰ ×”××©×™××” ×”×•×©×œ××”! ğŸ‰</h1>
            
            <div class="stars">â­â­â­</div>
            
            <p style="font-size: 1.3rem; margin-bottom: 30px;">
                ×”×¦×œ×—×ª× ×œ×¤×¦×— ××ª ×›×œ ×”×§×•×“×™× ×•×œ×”×©×œ×™× ××ª ×”××’×™×œ×”!<br/>
                ××“×™× ×ª ×™×©×¨××œ ×™×›×•×œ×” ×œ×”×™×•×ª ××•×›×¨×–×ª!
            </p>
            
            <div id="finalTime" class="final-time"></div>
            
            <div style="background: linear-gradient(135deg, rgba(0, 56, 168, 0.3), rgba(0, 81, 199, 0.3)); border: 3px solid var(--israel-blue); border-radius: 20px; padding: 40px; margin: 30px auto; max-width: 600px; box-shadow: 0 10px 40px rgba(0, 56, 168, 0.4);">
                <div style="font-size: 3rem; margin-bottom: 20px;">ğŸ‡®ğŸ‡±</div>
                <div style="font-size: 1.5rem; font-weight: 900; margin-bottom: 25px; color: var(--vintage-yellow); line-height: 1.6;">
                    "×× ×• ××›×¨×™×–×™× ×‘×–××ª ×¢×œ ×”×§××ª ××“×™× ×” ×™×”×•×“×™×ª ×‘××¨×¥ ×™×©×¨××œ,<br/>
                    ×”×™× ××“×™× ×ª ×™×©×¨××œ"
                </div>
                <div style="font-size: 1.1rem; color: rgba(255,255,255,0.9); margin-bottom: 15px;">
                    ×“×•×“ ×‘×Ÿ ×’×•×¨×™×•×Ÿ
                </div>
                <div style="font-size: 1rem; color: rgba(255,255,255,0.7);">
                    14 ×‘×××™ 1948 â€¢ 5 ×‘××™×™×¨ ×ª×©"×—
                </div>
            </div>
            
            <div style="background: rgba(255,255,255,0.1); border-radius: 15px; padding: 30px; margin-top: 30px; text-align: right; line-height: 1.8;">
                <p style="font-size: 1.1rem;">
                    ××—×¨×™ ×©× ×•×ª ×’×œ×•×ª, ××œ×—××•×ª ×•×××‘×§×™×,<br/>
                    ××—×¨×™ ×”×©×•××” ×•××¨×“ ×’×˜×• ×•×¨×©×”,<br/>
                    ××—×¨×™ ×”×”×¦×‘×¢×” ×‘××•"× ×‘-29 ×‘× ×•×‘××‘×¨ 1947,<br/>
                    ×”×’×™×¢ ×”×¨×’×¢ ×”×”×™×¡×˜×•×¨×™:<br/><br/>
                    
                    <strong style="color: var(--vintage-yellow); font-size: 1.2rem;">×”×¢× ×”×™×”×•×“×™ ×§× ×œ×ª×—×™×™×” ×‘××¨×¦×•!</strong>
                </p>
            </div>
        </div>
    </div>

    <script>
        // Game State
        let gameState = {
            currentStation: 0,
            unlockedStations: [],
            timeLeft: 90 * 60,
            startTime: null,
            timerInterval: null,
            
            // Station 1: Cipher
            cipherInput: '',
            
            // Station 2: Voting
            currentRound: 0,
            votes: { yes: 0, no: 0, abstain: 0 },
            votedCountries: new Set(),
            
            // Station 3: Signers
            selectedSigners: [],
            
            // Station 4: Timeline
            timelineOrder: [2, 4, 0, 3, 1], // Shuffled order - students need to arrange correctly
            
            // Station 5: Megillah
            selectedWords: [null, null, null]
        };

        // Data
        const cipherData = [
            { letter: '×', number: 1 }, { letter: '×‘', number: 2 }, { letter: '×’', number: 3 },
            { letter: '×“', number: 4 }, { letter: '×”', number: 5 }, { letter: '×•', number: 6 },
            { letter: '×–', number: 7 }, { letter: '×—', number: 8 }, { letter: '×˜', number: 9 },
            { letter: '×™', number: 10 }, { letter: '×›', number: 11 }, { letter: '×œ', number: 12 },
            { letter: '×', number: 13 }, { letter: '×Ÿ', number: 14 }, { letter: '×¡', number: 15 },
            { letter: '×¢', number: 16 }, { letter: '×¤', number: 17 }, { letter: '×¦', number: 18 },
            { letter: '×§', number: 19 }, { letter: '×¨', number: 20 }, { letter: '×©', number: 21 },
            { letter: '×ª', number: 22 }, { letter: ' ', number: 0 }
        ];
        
        const encodedMessage = [5,16,13,0,5,10,5,6,4,10,0,7,11,1,10,0,12,2,10,22,0,13,21,12,6];
        const correctAnswer = "×”×¢× ×”×™×”×•×“×™ ×–×›××™ ×œ×‘×™×ª ××©×œ×•";
        
        const votingRounds = [
            [
                { name: '××¨×¦×•×ª ×”×‘×¨×™×ª', vote: 'yes' },
                { name: '×‘×¨×™×ª ×”××•×¢×¦×•×ª', vote: 'yes' },
                { name: '×¦×¨×¤×ª', vote: 'yes' },
                { name: '×‘×¨×™×˜× ×™×”', vote: 'abstain' },
                { name: '×§× ×“×”', vote: 'yes' },
                { name: '×¡×™×Ÿ', vote: 'abstain' }
            ],
            [
                { name: '××•×¡×˜×¨×œ×™×”', vote: 'yes' },
                { name: '×‘×œ×’×™×”', vote: 'yes' },
                { name: '×‘×•×œ×™×‘×™×”', vote: 'yes' },
                { name: '×‘×¨×–×™×œ', vote: 'yes' },
                { name: '×‘×œ××¨×•×¡', vote: 'yes' },
                { name: '×§×•×¡×˜×” ×¨×™×§×”', vote: 'yes' }
            ],
            [
                { name: '×¦×›×•×¡×œ×•×‘×§×™×”', vote: 'yes' },
                { name: '×“× ××¨×§', vote: 'yes' },
                { name: '×”×¨×¤×•×‘×œ×™×§×” ×”×“×•××™× ×™×§× ×™×ª', vote: 'yes' },
                { name: '××§×•×•×“×•×¨', vote: 'yes' },
                { name: '×’×•××˜××œ×”', vote: 'yes' },
                { name: '×”××™×˜×™', vote: 'yes' }
            ],
            [
                { name: '××™×¡×œ× ×“', vote: 'yes' },
                { name: '×œ×™×‘×¨×™×”', vote: 'yes' },
                { name: '×œ×•×§×¡××‘×•×¨×’', vote: 'yes' },
                { name: '×”×•×œ× ×“', vote: 'yes' },
                { name: '× ×™×• ×–×™×œ× ×“', vote: 'yes' },
                { name: '× ×™×§×¨×’×•××”', vote: 'yes' }
            ],
            [
                { name: '× ×•×¨×•×•×’×™×”', vote: 'yes' },
                { name: '×¤× ××”', vote: 'yes' },
                { name: '×¤×¨×’×•×•××™', vote: 'yes' },
                { name: '×¤×¨×•', vote: 'yes' },
                { name: '×¤×™×œ×™×¤×™× ×™×', vote: 'yes' },
                { name: '×¤×•×œ×™×Ÿ', vote: 'yes' }
            ],
            [
                { name: '×©×‘×“×™×”', vote: 'yes' },
                { name: '××•×§×¨××™× ×”', vote: 'yes' },
                { name: '×“×¨×•× ××¤×¨×™×§×”', vote: 'yes' },
                { name: '××•×¨×•×’×•×•××™', vote: 'yes' },
                { name: '×•× ×¦×•××œ×”', vote: 'yes' },
                { name: '××¤×’× ×™×¡×˜×Ÿ', vote: 'no' }
            ],
            [
                { name: '×§×•×‘×”', vote: 'no' },
                { name: '××¦×¨×™×', vote: 'no' },
                { name: '×™×•×•×Ÿ', vote: 'no' },
                { name: '×”×•×“×•', vote: 'no' },
                { name: '××™×¨××Ÿ', vote: 'no' },
                { name: '×¢×™×¨××§', vote: 'no' }
            ],
            [
                { name: '×œ×‘× ×•×Ÿ', vote: 'no' },
                { name: '×¤×§×™×¡×˜×Ÿ', vote: 'no' },
                { name: '×¡×¢×•×“×™×”', vote: 'no' },
                { name: '×¡×•×¨×™×”', vote: 'no' },
                { name: '×˜×•×¨×§×™×”', vote: 'no' },
                { name: '×ª×™××Ÿ', vote: 'no' }
            ],
            [
                { name: '××¨×’× ×˜×™× ×”', vote: 'abstain' },
                { name: '×¦×™×œ×”', vote: 'abstain' },
                { name: '×§×•×œ×•××‘×™×”', vote: 'abstain' },
                { name: '××œ ×¡×œ×‘×“×•×¨', vote: 'abstain' },
                { name: '××ª×™×•×¤×™×”', vote: 'abstain' },
                { name: '×”×•× ×“×•×¨×¡', vote: 'abstain' }
            ],
            [
                { name: '××§×¡×™×§×•', vote: 'abstain' },
                { name: '×™×•×’×•×¡×œ×‘×™×”', vote: 'abstain' }
            ]
        ];
        
        // Signers data
        const signersData = [
            { 
                name: '×“×•×“ ×‘×Ÿ ×’×•×¨×™×•×Ÿ', 
                role: '×¨××© ×”×××©×œ×” ×”×–×× ×™×ª', 
                icon: 'ğŸ–ï¸',
                color: '#2c3e50',
                correct: true 
            },
            { 
                name: '×’×•×œ×“×” ×××™×¨', 
                role: '×—×‘×¨×ª ×”××•×¢×¦×”', 
                icon: 'ğŸ‘©â€ğŸ’¼',
                color: '#8e44ad',
                correct: true 
            },
            { 
                name: '××©×” ×©×¨×ª', 
                role: '×©×¨ ×”×—×•×¥', 
                icon: 'ğŸŒ',
                color: '#16a085',
                correct: true 
            },
            { 
                name: '×—×™×™× ×•×™×¦××Ÿ', 
                role: '× ×©×™× ×”×ª× ×•×¢×” ×”×¦×™×•× ×™×ª', 
                icon: 'ğŸ“',
                color: '#d35400',
                correct: false // ×œ× ×—×ª× ×¢×œ ×”××’×™×œ×” (×”×™×” ×‘×—×•"×œ)
            },
            { 
                name: '×× ×—× ×‘×’×™×Ÿ', 
                role: '×× ×”×™×’ ×”××¦"×œ', 
                icon: 'âš”ï¸',
                color: '#c0392b',
                correct: false // ×œ× ×—×ª× ×‘-1948
            },
            { 
                name: '×œ×•×™ ××©×›×•×œ', 
                role: '×¤×¢×™×œ ×¦×™×•× ×™ (×¨××© ×××©×œ×” ×œ×™××™×)', 
                icon: 'ğŸ›ï¸',
                color: '#2980b9',
                correct: false // ×œ× ×—×ª× ×¢×œ ×”××’×™×œ×” ×‘-1948
            }
        ];
        
        // Timeline events
        const timelineEvents = [
            { id: 0, text: '×”×¦×”×¨×ª ×‘×œ×¤×•×¨', year: 1917 },
            { id: 1, text: '×”×—×œ×˜×ª ×”××•"× ×¢×œ ×—×œ×•×§×ª ×”××¨×¥', year: 1947 },
            { id: 2, text: '×”×›×¨×–×ª ×”×¢×¦×××•×ª', year: 1948 },
            { id: 3, text: '×¤×œ×™×©×ª ×¦×‘××•×ª ×¢×¨×‘', year: 1948.01 },
            { id: 4, text: '×”×¤×¡×§×ª ××© ×•×¡×™×•× ××œ×—××ª ×”×©×—×¨×•×¨', year: 1949 }
        ];
        
        const correctTimelineOrder = [0, 1, 2, 3, 4]; // The correct chronological order
        
        const megillahWords = ['×—×™×¨×•×ª', '×¦×“×§', '×©×•×•×™×•×Ÿ'];

        // Utility Functions
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
        }

        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        function updateTimer() {
            const timerEl = document.getElementById('timer');
            timerEl.textContent = `â° ${formatTime(gameState.timeLeft)}`;
            
            if (gameState.timeLeft < 600) {
                timerEl.classList.add('warning');
            }
            
            if (gameState.timeLeft > 0) {
                gameState.timeLeft--;
            } else {
                clearInterval(gameState.timerInterval);
            }
        }

        function unlockStation(stationNum) {
            gameState.unlockedStations.push(stationNum);
            const lockEl = document.getElementById(`lock${stationNum}`);
            lockEl.innerHTML = 'ğŸ”“';
            lockEl.classList.add('unlocked');
        }

        // Start Game
        function startGame() {
            gameState.startTime = Date.now();
            showScreen('gameScreen');
            renderStation(0);
            
            gameState.timerInterval = setInterval(updateTimer, 1000);
        }

        // Render Stations
        function renderStation(stationNum) {
            gameState.currentStation = stationNum;
            const container = document.getElementById('stationContainer');
            
            if (stationNum === 0) {
                container.innerHTML = renderStation1();
            } else if (stationNum === 1) {
                container.innerHTML = renderStation2();
                updateVoteCounter();
            } else if (stationNum === 2) {
                container.innerHTML = renderStation3();
            } else if (stationNum === 3) {
                container.innerHTML = renderStation4();
                initializeDragAndDrop();
            } else if (stationNum === 4) {
                container.innerHTML = renderStation5();
            }
        }

        // STATION 1: Cipher
        function renderStation1() {
            return `
                <div class="station-card">
                    <div class="station-header">
                        <div class="station-number">×ª×—× ×” 1 ××ª×•×š 5</div>
                        <h2 class="station-title">ğŸ” ×”×§×•×“ ×”×‘×¨×™×˜×™</h2>
                        <p class="station-description">
                            ×”××•×“×™×¢×™×Ÿ ×”×‘×¨×™×˜×™ ×”×©×ª××© ×‘×¦×•×¤×Ÿ ×¤×©×•×˜. ×”×©×ª××©×• ×‘×˜×‘×œ×” ×›×“×™ ×œ×¤×¢× ×— ××ª ×”××¡×¨ ×”×—×©×•×‘.
                            ×›×œ ××¡×¤×¨ ××™×™×¦×’ ××•×ª ×¢×‘×¨×™×ª.
                        </p>
                    </div>
                    
                    <div class="cipher-table">
                        ${cipherData.map(item => `
                            <div class="cipher-cell">
                                <div class="cipher-letter">${item.letter}</div>
                                <div class="cipher-number">${item.number}</div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; margin-top: 20px; text-align: center; font-size: 1.3rem; font-family: Rubik; letter-spacing: 3px; direction: rtl;">
                        ${encodedMessage.join(' - ')}
                    </div>
                    
                    <div class="cipher-input-section">
                        <input
                            type="text"
                            id="cipherInput"
                            class="cipher-input"
                            placeholder="×”×§×œ×™×“×• ××ª ×”××©×¤×˜ ×”××¤×•×¢× ×—..."
                            onkeyup="if(event.key==='Enter') checkStation1()"
                        />
                        
                        <button class="submit-button" onclick="checkStation1()">
                            âœ“ ×‘×“×•×§ ×ª×©×•×‘×”
                        </button>
                        
                        <div id="station1Message"></div>
                    </div>
                </div>
            `;
        }

        function checkStation1() {
            const input = document.getElementById('cipherInput').value.trim();
            const msgEl = document.getElementById('station1Message');
            
            if (input === correctAnswer) {
                msgEl.innerHTML = '<div class="message success">××¦×•×™×Ÿ! ×¤×™×¦×—×ª× ××ª ×”×§×•×“!</div>';
                setTimeout(() => {
                    unlockStation(0);
                    renderStation(1);
                }, 1500);
            } else {
                msgEl.innerHTML = '<div class="message error">×œ× × ×›×•×Ÿ. × ×¡×• ×©×•×‘!</div>';
            }
        }

        // STATION 2: Voting
        function renderStation2() {
            const currentRoundCountries = votingRounds[gameState.currentRound];
            
            return `
                <div class="station-card">
                    <div class="station-header">
                        <div class="station-number">×ª×—× ×” 2 ××ª×•×š 5</div>
                        <h2 class="station-title">ğŸ—³ï¸ ××¤×ª ×”×“×¨×›×™×</h2>
                        <p class="station-description">
                            29 ×‘× ×•×‘××‘×¨ 1947 - ×”××•"× ××¦×‘×™×¢ ×¢×œ ×—×œ×•×§×ª ×”××¨×¥.<br/>
                            ×”×¦×‘×™×¢×• ×‘×©× ×›×œ ××“×™× ×” ×•××“×™× ×”. ×¦×¨×™×›×™× 33 ×§×•×œ×•×ª "×‘×¢×“" ×›×“×™ ×œ×¢×‘×•×¨!
                        </p>
                    </div>
                    
                    <div class="voting-area">
                        ${currentRoundCountries.map(country => {
                            const isVoted = gameState.votedCountries.has(country.name);
                            return `
                                <div class="country-card">
                                    <div class="country-name">
                                        ${isVoted ? (country.vote === 'yes' ? 'âœ“' : country.vote === 'no' ? 'âœ—' : 'â—‹') : ''}
                                        ${country.name}
                                    </div>
                                    
                                    <div class="vote-buttons">
                                        <button
                                            class="vote-btn yes"
                                            onclick="handleVote('${country.name}', 'yes')"
                                            ${isVoted ? 'disabled' : ''}
                                        >
                                            ×‘×¢×“
                                        </button>
                                        <button
                                            class="vote-btn no"
                                            onclick="handleVote('${country.name}', 'no')"
                                            ${isVoted ? 'disabled' : ''}
                                        >
                                            × ×’×“
                                        </button>
                                        <button
                                            class="vote-btn abstain"
                                            onclick="handleVote('${country.name}', 'abstain')"
                                            ${isVoted ? 'disabled' : ''}
                                        >
                                            × ×× ×¢
                                        </button>
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                    
                    <div class="vote-counter">
                        <div class="vote-counter-title">×ª×•×¦××•×ª ×”×”×¦×‘×¢×” ×¢×“ ×›×”:</div>
                        <div class="vote-numbers">
                            <div class="vote-stat">
                                <div class="vote-stat-number" style="color: var(--success-green);" id="yesCount">0</div>
                                <div class="vote-stat-label">×‘×¢×“</div>
                            </div>
                            <div class="vote-stat">
                                <div class="vote-stat-number" style="color: var(--danger-red);" id="noCount">0</div>
                                <div class="vote-stat-label">× ×’×“</div>
                            </div>
                            <div class="vote-stat">
                                <div class="vote-stat-number" style="color: #7f8c8d;" id="abstainCount">0</div>
                                <div class="vote-stat-label">× ×× ×¢</div>
                            </div>
                        </div>
                    </div>
                    
                    ${gameState.currentRound === votingRounds.length - 1 && gameState.votedCountries.size === 56 ? `
                        <button class="submit-button" onclick="checkStation2()">
                            âœ“ ×¡×™×™××ª×™ ×”×¦×‘×¢×”
                        </button>
                        <div id="station2Message"></div>
                    ` : ''}
                </div>
            `;
        }

        function handleVote(countryName, voteType) {
            gameState.votedCountries.add(countryName);
            gameState.votes[voteType]++;
            
            updateVoteCounter();
            
            const totalVotedInRound = votingRounds[gameState.currentRound].filter(c => 
                gameState.votedCountries.has(c.name)
            ).length;
            
            if (totalVotedInRound === votingRounds[gameState.currentRound].length) {
                if (gameState.currentRound < votingRounds.length - 1) {
                    setTimeout(() => {
                        gameState.currentRound++;
                        renderStation(1);
                    }, 500);
                } else {
                    setTimeout(() => {
                        renderStation(1);
                    }, 500);
                }
            } else {
                renderStation(1);
            }
        }

        function updateVoteCounter() {
            const yesEl = document.getElementById('yesCount');
            const noEl = document.getElementById('noCount');
            const abstainEl = document.getElementById('abstainCount');
            
            if (yesEl) yesEl.textContent = gameState.votes.yes;
            if (noEl) noEl.textContent = gameState.votes.no;
            if (abstainEl) abstainEl.textContent = gameState.votes.abstain;
        }

        function checkStation2() {
            const msgEl = document.getElementById('station2Message');
            
            if (gameState.votes.yes >= 33) {
                msgEl.innerHTML = '<div class="message success">×›×œ ×”×›×‘×•×“! ×”×”×¦×‘×¢×” ×¢×‘×¨×”!</div>';
                setTimeout(() => {
                    unlockStation(1);
                    renderStation(2);
                }, 1500);
            } else {
                msgEl.innerHTML = `<div class="message error">×¦×¨×™×›×™× ×œ×¤×—×•×ª 33 ×§×•×œ×•×ª "×‘×¢×“". ×™×© ×œ×›× ${gameState.votes.yes}.</div>`;
            }
        }

        // STATION 3: Signers
        function renderStation3() {
            return `
                <div class="station-card">
                    <div class="station-header">
                        <div class="station-number">×ª×—× ×” 3 ××ª×•×š 5</div>
                        <h2 class="station-title">ğŸ–Šï¸ ×”×—×•×ª××™× ×¢×œ ×”××’×™×œ×”</h2>
                        <p class="station-description">
                            37 ×× ×©×™× ×—×ª××• ×¢×œ ××’×™×œ×ª ×”×¢×¦×××•×ª ×‘-14 ×‘×××™ 1948.<br/>
                            <strong>×‘×—×¨×• 3 ×“××•×™×•×ª ×©×—×ª××• ×¢×œ ×”××’×™×œ×”:</strong>
                        </p>
                        <div style="text-align: center; margin-top: 15px; padding: 12px; background: rgba(244, 208, 63, 0.15); border-radius: 10px; border: 1px solid rgba(244, 208, 63, 0.3);">
                            <a href="https://www.wikiwand.com/he/articles/%D7%94%D7%9B%D7%A8%D7%96%D7%AA_%D7%94%D7%A2%D7%A6%D7%9E%D7%90%D7%95%D7%AA" 
                               target="_blank" 
                               style="color: var(--vintage-yellow); text-decoration: none; font-weight: 700; font-size: 0.95rem;">
                                ğŸ“¸ ×œ×—×¦×• ×›××Ÿ ×œ×¦×¤×™×™×” ×‘×ª××•× ×•×ª ×”×××™×ª×™×•×ª ×©×œ ×›×œ ×”×—×•×ª××™×
                            </a>
                        </div>
                    </div>
                    
                    <div class="signers-grid">
                        ${signersData.map((signer, idx) => {
                            const isSelected = gameState.selectedSigners.includes(idx);
                            const isDisabled = gameState.selectedSigners.length >= 3 && !isSelected;
                            
                            return `
                                <div 
                                    class="signer-card ${isSelected ? 'selected' : ''} ${isDisabled ? 'disabled' : ''}"
                                    onclick="toggleSigner(${idx})"
                                >
                                    <div style="
                                        width: 100px; 
                                        height: 100px; 
                                        background: ${isSelected ? 'linear-gradient(135deg, #27ae60, #229954)' : `linear-gradient(135deg, ${signer.color}, ${signer.color}dd)`}; 
                                        border-radius: 50%; 
                                        display: flex; 
                                        align-items: center; 
                                        justify-content: center; 
                                        font-size: 3.5rem; 
                                        margin-bottom: 15px;
                                        border: 4px solid rgba(255,255,255,0.3);
                                        box-shadow: 0 4px 15px rgba(0,0,0,0.3);
                                    ">
                                        ${isSelected ? 'âœ“' : signer.icon}
                                    </div>
                                    <div class="signer-name">${signer.name}</div>
                                    <div class="signer-role">${signer.role}</div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                    
                    <div style="text-align: center; margin-top: 20px; font-size: 1.1rem; color: var(--vintage-yellow);">
                        × ×‘×—×¨×•: ${gameState.selectedSigners.length} / 3
                    </div>
                    
                    <button 
                        class="submit-button" 
                        onclick="checkStation3()"
                        ${gameState.selectedSigners.length !== 3 ? 'disabled' : ''}
                    >
                        âœ“ ×‘×“×•×§ ×ª×©×•×‘×”
                    </button>
                    
                    <div id="station3Message"></div>
                </div>
            `;
        }

        function toggleSigner(idx) {
            const signerIndex = gameState.selectedSigners.indexOf(idx);
            
            if (signerIndex > -1) {
                gameState.selectedSigners.splice(signerIndex, 1);
            } else if (gameState.selectedSigners.length < 3) {
                gameState.selectedSigners.push(idx);
            }
            
            renderStation(2);
        }

        function checkStation3() {
            const msgEl = document.getElementById('station3Message');
            
            const allCorrect = gameState.selectedSigners.every(idx => signersData[idx].correct);
            const allSelected = gameState.selectedSigners.length === 3;
            
            if (allCorrect && allSelected) {
                msgEl.innerHTML = '<div class="message success">××¦×•×™×Ÿ! ×–×™×”×™×ª× × ×›×•×Ÿ ××ª ×”×—×•×ª××™×!</div>';
                setTimeout(() => {
                    unlockStation(2);
                    renderStation(3);
                }, 1500);
            } else {
                msgEl.innerHTML = '<div class="message error">×œ× × ×›×•×Ÿ. ×‘×“×§×• ×©×•×‘ - ×œ× ×›×œ ××™ ×©×‘×—×¨×ª× ×—×ª× ×¢×œ ×”××’×™×œ×”.</div>';
            }
        }

        // STATION 4: Timeline
        function renderStation4() {
            return `
                <div class="station-card">
                    <div class="station-header">
                        <div class="station-number">×ª×—× ×” 4 ××ª×•×š 5</div>
                        <h2 class="station-title">ğŸ“… ×¡×“×¨ ×”××™×¨×•×¢×™×</h2>
                        <p class="station-description">
                            ×¡×“×¨×• ××ª ×”××™×¨×•×¢×™× ×”×”×™×¡×˜×•×¨×™×™× ×œ×¤×™ ×¡×“×¨ ×›×¨×•× ×•×œ×•×’×™ - ××”×¨××©×•×Ÿ ×œ××—×¨×•×Ÿ.<br/>
                            <strong>×’×¨×¨×• ××ª ×”××™×¨×•×¢×™× ×œ××§×•× ×”× ×›×•×Ÿ:</strong>
                        </p>
                    </div>
                    
                    <div class="timeline-container">
                        <div class="timeline-events" id="timelineEvents">
                            ${gameState.timelineOrder.map((eventId, position) => {
                                const event = timelineEvents[eventId];
                                return `
                                    <div 
                                        class="timeline-event" 
                                        draggable="true"
                                        data-position="${position}"
                                        data-event-id="${eventId}"
                                    >
                                        <span class="event-number">${position + 1}</span>
                                        <span class="event-text">${event.text}</span>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>
                    
                    <button class="submit-button" onclick="checkStation4()">
                        âœ“ ×‘×“×•×§ ×¡×“×¨
                    </button>
                    
                    <div id="station4Message"></div>
                </div>
            `;
        }

        let draggedElement = null;

        function initializeDragAndDrop() {
            const events = document.querySelectorAll('.timeline-event');
            
            events.forEach(event => {
                event.addEventListener('dragstart', function(e) {
                    draggedElement = this;
                    this.classList.add('dragging');
                });
                
                event.addEventListener('dragend', function(e) {
                    this.classList.remove('dragging');
                });
                
                event.addEventListener('dragover', function(e) {
                    e.preventDefault();
                });
                
                event.addEventListener('drop', function(e) {
                    e.preventDefault();
                    if (draggedElement !== this) {
                        const draggedPos = parseInt(draggedElement.dataset.position);
                        const targetPos = parseInt(this.dataset.position);
                        
                        // Swap in timeline order
                        const temp = gameState.timelineOrder[draggedPos];
                        gameState.timelineOrder[draggedPos] = gameState.timelineOrder[targetPos];
                        gameState.timelineOrder[targetPos] = temp;
                        
                        renderStation(3);
                    }
                });
            });
        }

        function checkStation4() {
            const msgEl = document.getElementById('station4Message');
            
            const isCorrect = gameState.timelineOrder.every((eventId, idx) => eventId === correctTimelineOrder[idx]);
            
            if (isCorrect) {
                msgEl.innerHTML = '<div class="message success">××¢×•×œ×”! ×”×¡×“×¨ ×”×›×¨×•× ×•×œ×•×’×™ × ×›×•×Ÿ!</div>';
                
                // Mark all events as correct
                document.querySelectorAll('.timeline-event').forEach(el => {
                    el.classList.add('correct');
                });
                
                setTimeout(() => {
                    unlockStation(3);
                    renderStation(4);
                }, 1500);
            } else {
                msgEl.innerHTML = '<div class="message error">×”×¡×“×¨ ×œ× × ×›×•×Ÿ. × ×¡×• ×©×•×‘!</div>';
            }
        }

        // STATION 5: Megillah
        function renderStation5() {
            return `
                <div class="station-card">
                    <div class="station-header">
                        <div class="station-number">×ª×—× ×” 5 ××ª×•×š 5</div>
                        <h2 class="station-title">ğŸ“œ ×—×ª×™××” ×¢×œ ×”×—×•×¤×©</h2>
                        <p class="station-description">
                            ××’×™×œ×ª ×”×¢×¦×××•×ª ×›××¢×˜ ××•×›× ×”! ×”×©×œ×™××• ××ª ×”×¢×¨×›×™× ×”×—×¡×¨×™×.
                        </p>
                    </div>
                    
                    <div class="megillah-text">
                        ××“×™× ×ª ×™×©×¨××œ ×ª×”× ×¤×ª×•×—×” ×œ×¢×œ×™×™×” ×™×”×•×“×™×ª ×•×œ×§×™×‘×•×¥ ×’×œ×•×™×•×ª; ×ª×©×§×•×“ ×¢×œ ×¤×™×ª×•×— ×”××¨×¥ ×œ×˜×•×‘×ª ×›×œ ×ª×•×©×‘×™×”;
                        ×ª×”× ××•×©×ª×ª×ª ×¢×œ ×™×¡×•×“×•×ª ×”<span class="word-blank">${gameState.selectedWords[0] || '______'}</span>,
                        ×”<span class="word-blank">${gameState.selectedWords[1] || '______'}</span>
                        ×•×”×©×œ×•× ×›×—×–×•× × ×©×œ × ×‘×™××™ ×™×©×¨××œ;
                        ×ª×§×™×™× <span class="word-blank">${gameState.selectedWords[2] || '______'}</span> ×–×›×•×™×•×ª ×—×‘×¨×ª×™ ×•××“×™× ×™ ×’××•×¨ ×œ×›×œ ××–×¨×—×™×” ×‘×œ×™ ×”×‘×“×œ ×“×ª, ×’×–×¢ ×•××™×Ÿ.
                    </div>
                    
                    <div class="word-options">
                        ${megillahWords.map((word, idx) => `
                            <div
                                class="word-option ${gameState.selectedWords.includes(word) ? 'selected' : ''}"
                                onclick="selectWord('${word}')"
                            >
                                ${word}
                            </div>
                        `).join('')}
                    </div>
                    
                    <button
                        class="submit-button"
                        onclick="checkStation5()"
                        ${gameState.selectedWords.some(w => w === null) ? 'disabled' : ''}
                    >
                        âœ“ ×”×©×œ× ××’×™×œ×”
                    </button>
                    
                    <div id="station5Message"></div>
                </div>
            `;
        }

        function selectWord(word) {
            const firstEmpty = gameState.selectedWords.findIndex(w => w === null);
            if (firstEmpty !== -1 && !gameState.selectedWords.includes(word)) {
                gameState.selectedWords[firstEmpty] = word;
                renderStation(4);
            }
        }

        function checkStation5() {
            const correct = gameState.selectedWords.every((word, idx) => word === megillahWords[idx]);
            const msgEl = document.getElementById('station5Message');
            
            if (correct) {
                msgEl.innerHTML = '<div class="message success">×”×¦×œ×—×ª×! ×”××’×™×œ×” ×”×•×©×œ××”!</div>';
                setTimeout(() => {
                    unlockStation(4);
                    clearInterval(gameState.timerInterval);
                    
                    const timeTaken = Math.floor((Date.now() - gameState.startTime) / 1000);
                    document.getElementById('finalTime').textContent = `â±ï¸ ×–××Ÿ ×‘×™×¦×•×¢: ${formatTime(timeTaken)}`;
                    
                    showScreen('victoryScreen');
                }, 1500);
            } else {
                msgEl.innerHTML = '<div class="message error">×œ× × ×›×•×Ÿ. ×‘×“×§×• ×©×•×‘ ××ª ×”××™×œ×™×.</div>';
            }
        }
    </script>
</body>
</html>
